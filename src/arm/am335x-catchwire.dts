/*
 * Copyright (C) 2012 Texas Instruments Incorporated - http://www.ti.com/
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */
/dts-v1/;

#include "am33xx.dtsi"

/ {
	model = "TI AM335x CATCHWIRE";
	compatible = "ti,am33xx";

	memory {
		device_type = "memory";
		reg = <0x80000000 0x20000000>; /* 512 MB */
	};

	vmmcsd_fixed: fixedregulator@0 {
		compatible = "regulator-fixed";
		regulator-name = "vmmcsd_fixed";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
	};
};

&am33xx_pinmux {
	pinctrl-names = "default";
	pinctrl-0 = <&clkout2_pin>;

	i2c0_pins: pinmux_i2c0_pins {
		pinctrl-single,pins = <
			0x188 (PIN_INPUT_PULLUP | MUX_MODE0)	/* i2c0_sda.i2c0_sda */
			0x18c (PIN_INPUT_PULLUP | MUX_MODE0)	/* i2c0_scl.i2c0_scl */
		>;
	};

	uart0_pins: pinmux_uart0_pins {
		pinctrl-single,pins = <
			0x168 0x36
			0x16c 0xe
			0x170 0x30
			0x174 0x0
		>;
	};

	clkout2_pin: pinmux_clkout2_pin {
		pinctrl-single,pins = <
			AM33XX_IOPAD(0x9b4, PIN_OUTPUT_PULLDOWN | MUX_MODE3)	/* xdma_event_intr1.clkout2 */
		>;
	};

	gpio_pin: pinmux_gpio_pin {
		pinctrl-single,pins = <
			0x0 0x27
			0x4 0x27
			0x1e8 0x7
		>;
	};

	cpsw_default: cpsw_default {
		pinctrl-single,pins = <
			0x114 0x2
			0x118 0x22
			0x11c 0x2
			0x120 0x2
			0x124 0x2
			0x128 0x2
			0x12c 0x2
			0x130 0x22
			0x134 0x22
			0x138 0x22
			0x13c 0x22
			0x140 0x22
			0x40 0x2
			0x44 0x22
			0x48 0x2
			0x4c 0x2
			0x50 0x2
			0x54 0x2
			0x58 0x2
			0x5c 0x22
			0x60 0x22
			0x64 0x22
			0x68 0x22
			0x6c 0x22
		>;
	};

	cpsw_sleep: cpsw_sleep {
		pinctrl-single,pins = <
			0x114 0x27
			0x118 0x27
			0x11c 0x27
			0x120 0x27
			0x124 0x27
			0x128 0x27
			0x12c 0x27
			0x130 0x27
			0x134 0x27
			0x138 0x27
			0x13c 0x27
			0x140 0x27
			0x40 0x27
			0x44 0x27
			0x48 0x27
			0x4c 0x27
			0x50 0x27
			0x54 0x27
			0x58 0x27
			0x5c 0x27
			0x60 0x27
			0x64 0x27
			0x68 0x27
			0x6c 0x27
		>;
	};

	davinci_mdio_default: davinci_mdio_default {
		pinctrl-single,pins = <
			0x148 0x70
			0x14c 0x10
		>;
	};

	davinci_mdio_sleep: davinci_mdio_sleep {
		pinctrl-single,pins = <
			0x148 0x27
			0x14c 0x27
		>;
	};

	mmc1_pins_default: pinmux_mmc1_pins {
		pinctrl-single,pins = <
			0xf0 0x30
			0xf4 0x30
			0xf8 0x30
			0xfc 0x30
			0x100 0x30
			0x104 0x30
			0x88 0x2f
		>;
	};

	mmc1_pins_sleep: pinmux_mmc1_pins_sleep {
		pinctrl-single,pins = <
			0xf0 0x27
			0xf4 0x27
			0xf8 0x27
			0xfc 0x27
			0x100 0x27
			0x104 0x27
			0x88 0x27
		>;
	};
};

&uart0 {
	pinctrl-names = "default";
	pinctrl-0 = <&uart0_pins>;

	status = "okay";
};

&usb {
	status = "okay";

	control@44e10620 {
		status = "okay";
	};

	usb-phy@47401b00 {
		status = "okay";
	};

	usb@47401000 {
		dr_mode = "host";
	};

	usb@47401800 {
		status = "okay";
		dr_mode = "host";
	};

	dma-controller@47402000  {
		status = "okay";
	};
};

&i2c0 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pins>;

	status = "okay";
	clock-frequency = <100000>;
	sleep-sequence = <0x2240b6d 0x2241002 0x2240b6d 0x2241002 0x2240b6c 0x2241186 0x2240b6c 0x2241186>;
	wake-sequence = <0x2240b6d 0x2241008 0x2240b6d 0x2241008 0x2240b6c 0x2241186 0x2240b6c 0x2241186>;


	tps: tps@24 {
		reg = <0x24>;
	};

	baseboard_eeprom: baseboard_eeprom@50 {
		compatible = "at,24c256";
		reg = <0x50>;
	};
};

&tps {
	compatible = "ti,tps65217";

	regulators {
		#address-cells = <0x1>;
		#size-cells = <0x0>;

		dcdc1_reg: regulator@0 {
			reg = <0x0>;
			regulator-compatible = "dcdc1";
			regulator-always-on;
		};

		dcdc2_reg: regulator@1 {
			reg = <0x1>;
			regulator-compatible = "dcdc2";
			/* FIXME: VDD_MPU voltage limits 0.95V - 1.325V with +/-4% tolerance */
			regulator-name = "vdd_mpu";
			regulator-min-microvolt = <0xe1d48>;
			regulator-max-microvolt = <0x1437c8>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc3_reg: regulator@2 {
			reg = <0x2>;
			regulator-compatible = "dcdc3";
			/* VDD_CORE voltage limits 0.95V - 1.1V with +/-4% tolerance */
			regulator-name = "vdd_core";
			regulator-min-microvolt = <925000>;
			regulator-max-microvolt = <1150000>;
			regulator-boot-on;
			regulator-always-on;
		};

		ldo1_reg: regulator@3 {
			reg = <0x3>;
			regulator-compatible = "ldo1";
			regulator-always-on;
		};

		ldo2_reg: regulator@4 {
			reg = <0x4>;
			regulator-compatible = "ldo2";
			regulator-always-on;
		};

		ldo3_reg: regulator@5 {
			reg = <0x5>;
			regulator-compatible = "ldo3";
			regulator-always-on;
			regulator-min-microvolt = <0x1b7740>;
			regulator-max-microvolt = <0x1b7740>;
		};

		ldo4_reg: regulator@6 {
			reg = <0x6>;
			regulator-compatible = "ldo4";
			regulator-always-on;
		};

		rtc@44e3e000 {
			ti,system-power-controller;
		};
	};
};

&cpsw_emac0 {
	phy_id = <&davinci_mdio>, <3>;
	phy-mode = "rgmii-txid";
};

&cpsw_emac1 {
	phy_id = <&davinci_mdio>, <1>;
	phy-mode = "rgmii-txid";
};

&mac {
	pinctrl-names = "default", "sleep";
	pinctrl-0 = <&cpsw_default>;
	pinctrl-1 = <&cpsw_sleep>;

};

&davinci_mdio {
	pinctrl-names = "default", "sleep";
	pinctrl-0 = <&davinci_mdio_default>;
	pinctrl-1 = <&davinci_mdio_sleep>;
};

&mmc1 {
	status = "okay";
	bus-width = <0x4>;
	pinctrl-names = "default";
	pinctrl-0 = <&mmc1_pins_default>;
	gpios = <0x2a 0x13 0x1>;
	cd-gpios = <&gpio0 0x12 GPIO_ACTIVE_HIGH>;
	cd-inverted;
	vmmc-supply = <&vmmcsd_fixed>;
};

&aes {
	status = "okay";
};

&sham {
	status = "okay";
};
